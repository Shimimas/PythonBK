from bs4 import BeautifulSoup

with open('../materials/evilcorp.html') as html_file:
    soup = BeautifulSoup(html_file, 'html.parser')
soup.title.string = "Evil Corp - Stealing your money every day"
pronoun = soup.body.p.contents[1].contents[0].contents[0]
name = soup.body.p.contents[1].contents[1]
new_tag = soup.new_tag("h1")
soup.body.append(new_tag)
soup.body.h1.string = f"{pronoun}{name}, you are hacked!"
new_script = soup.new_tag("script")
soup.body.append(new_script)
soup.body.script.string ="""
    hacked = function() {
        alert('hacked');
    }
    window.addEventListener('load', 
        function() { 
        var f = document.querySelector("form");
        f.setAttribute("onsubmit", "hacked()");
        },
        false
    );"""
soup.body.find_all('p')[-1].a.string = "Fsociety"
soup.body.find_all('p')[-1].a['href'] = "https://mrrobot.fandom.com/wiki/Fsociety"
with open("../materials/evilcorp_hacked.html", "w") as file_write:
    file_write.write(soup.prettify())